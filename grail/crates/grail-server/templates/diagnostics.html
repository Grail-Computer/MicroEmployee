{% extends "layout.html" %}
{% block title %}Grail | Diagnostics{% endblock %}
{% block content %}
  <h2>Diagnostics</h2>
  <p class="section-desc">Run quick self-tests without sending messages in Slack or Telegram.</p>

  <form method="post" action="/admin/diagnostics/codex">
    <button type="submit">Run Codex Self-Test</button>
  </form>

  {% if codex_error.is_some() %}
    <div class="kv mt-md" style="border-color: rgba(255, 107, 107, 0.25);">
      <div class="k">Codex Self-Test Error</div>
      <pre class="v text-danger" style="white-space: pre-wrap;">{{ codex_error.as_ref().unwrap() }}</pre>
    </div>
  {% endif %}

  {% if codex_result.is_some() %}
    <div class="kv mt-md">
      <div class="k">Codex Self-Test Output</div>
      <pre class="v" style="white-space: pre-wrap;">{{ codex_result.as_ref().unwrap() }}</pre>
    </div>
  {% endif %}
{% endblock %}
