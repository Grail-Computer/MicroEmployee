{% extends "layout.html" %}
{% block title %}Grail | Status{% endblock %}
{% block content %}
  <h2>Status</h2>
  <p class="section-desc">System health and configuration overview for this Grail instance.</p>

  <div class="grid">
    <div class="kv">
      <div class="k">Slack Signing Secret</div>
      <div class="v">
        {% if slack_signing_secret_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">Slack Bot Token</div>
      <div class="v">
        {% if slack_bot_token_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">Telegram Bot Token</div>
      <div class="v">
        {% if telegram_bot_token_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">Telegram Webhook Secret</div>
      <div class="v">
        {% if telegram_webhook_secret_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">OpenAI API Key</div>
      <div class="v">
        {% if openai_api_key_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">Master Key</div>
      <div class="v">
        {% if master_key_set %}
          <span class="pill ok">set</span>
        {% else %}
          <span class="pill bad">missing</span>
        {% endif %}
      </div>
    </div>
    <div class="kv">
      <div class="k">Queue Depth</div>
      <div class="v"><span class="pill">{{ queue_depth }}</span></div>
    </div>
    <div class="kv">
      <div class="k">Active Task</div>
      <div class="v">
        {% if active_task_id != "" %}
          <span class="pill ok">#{{ active_task_id }}</span>
        {% else %}
          <span class="pill">idle</span>
        {% endif %}
      </div>
      {% if active_task_started_at != "" %}
        <div class="mt-sm text-muted" style="font-size: 12px;">
          started at {{ active_task_started_at }}
        </div>
      {% endif %}
    </div>
    <div class="kv">
      <div class="k">Pending Approvals</div>
      <div class="v"><span class="pill">{{ pending_approvals }}</span></div>
      <div class="mt-sm text-muted" style="font-size: 12px;">
        Manage in <a href="/admin/approvals">Approvals</a>
      </div>
    </div>
    <div class="kv">
      <div class="k">Permissions</div>
      <div class="v"><span class="pill">{{ permissions_mode }}</span></div>
    </div>
    <div class="kv">
      <div class="k">Worker Lock</div>
      <div class="v"><span class="pill">{{ worker_lock_owner }}</span></div>
    </div>
    <div class="kv">
      <div class="k">Guardrails</div>
      <div class="v"><span class="pill">{{ guardrails_enabled }}</span></div>
      <div class="mt-sm text-muted" style="font-size: 12px;">
        Manage in <a href="/admin/guardrails">Guardrails</a>
      </div>
    </div>
  </div>

  <h3>Endpoints</h3>
  <div class="grid">
    <div class="kv">
      <div class="k">Slack Events</div>
      <div class="v"><span class="pill" style="word-break: break-all;">POST {{ slack_events_url }}</span></div>
    </div>
    <div class="kv">
      <div class="k">Slack Interactivity</div>
      <div class="v"><span class="pill" style="word-break: break-all;">POST {{ slack_actions_url }}</span></div>
    </div>
    <div class="kv">
      <div class="k">Telegram Webhook</div>
      <div class="v"><span class="pill" style="word-break: break-all;">POST {{ telegram_webhook_url }}</span></div>
    </div>
  </div>
{% endblock %}
